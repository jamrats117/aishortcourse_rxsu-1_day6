Prompt
‡∏â‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á Google Apps Script ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Dialogflow ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå:
‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠: ‡∏â‡∏±‡∏ô‡πÉ‡∏ä‡πâ Google Apps Script ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤ SHEET_ID ‡πÅ‡∏•‡∏∞ SHEET_NAME ‡πÑ‡∏ß‡πâ‡πÉ‡∏ô Script Properties
‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheet: Google Sheet ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ 6 ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:
‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 1: code
‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 2: herb (‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£)
‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 3: effect (‡∏ú‡∏•‡∏ï‡πà‡∏≠ INR)
‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 4: description
‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 5: loe (‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô)
‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 6: ref (‡πÅ‡∏´‡∏•‡πà‡∏á‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á)
‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡πÅ‡∏ä‡∏ó‡∏ö‡∏≠‡∏ó:
‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÉ‡∏ô‡πÅ‡∏ä‡∏ó‡∏ö‡∏≠‡∏ó ‡πÄ‡∏ä‡πà‡∏ô "‡∏Ç‡∏¥‡∏á" ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÑ‡∏õ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå herb ‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå herb ‡πÅ‡∏•‡∏∞ effect ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Dialogflow:
‡∏â‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å API response ‡∏Ç‡∏≠‡∏á Dialogflow ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå herb ‡∏ã‡∏∂‡πà‡∏á‡∏à‡∏∞‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÇ‡∏î‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô outputContexts ‡∏ï‡∏≤‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á API response ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

{
  "responseId": "86738d64-b174-454a-ab2e-bd056cd872ab-996f169b",
  "queryResult": {
    "queryText": "‡πÉ‡∏ä‡πà‡∏à‡πâ‡∏≤",
    "action": "get_herb_post_inr.get_herb_post_inr-yes",
    "parameters": {},
    "allRequiredParamsPresent": true,
    "fulfillmentMessages": [
      {
        "text": {
          "text": [
            ""
          ]
        }
      }
    ],
    "outputContexts": [
      {
        "name": "projects/herb-4-110625-btkk/agent/sessions/6f72a44f-d335-26dd-c8dd-b949fc0edbc4/contexts/get_herb_post_inr-followup",
        "lifespanCount": 1,
        "parameters": {
          "herb.original": "‡πÄ‡∏ó‡∏µ‡∏¢‡∏°",
          "herb": "‡∏Å‡∏£‡∏∞‡πÄ‡∏ó‡∏µ‡∏¢‡∏°"
        }
      }
    ],
    "intent": {
      "name": "projects/herb-4-110625-btkk/agent/intents/ac8a8ed8-d61b-4134-9b4c-527dc7a6d9aa",
      "displayName": "get_herb_post_inr - yes"
    },
    "intentDetectionConfidence": 1,
    "languageCode": "th"
  }
}

‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:
‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Dialogflow: ‡∏£‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏à‡∏≤‡∏Å‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå herb ‡πÉ‡∏ô outputContexts ‡∏Ç‡∏≠‡∏á API response
‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheets: ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå herb ‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå effect ‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô
‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö:

‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£
üåø ‡∏ä‡∏∑‡πà‡∏≠: ‡∏Å‡∏£‡∏∞‡πÄ‡∏ó‡∏µ‡∏¢‡∏° (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 1)
üîé ‡∏ú‡∏•‡∏ï‡πà‡∏≠ INR: ‡πÄ‡∏û‡∏¥‡πà‡∏° INR (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 3)
üìñ ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢: ‡∏¢‡∏±‡∏ö‡∏¢‡∏±‡πâ‡∏á‡πÄ‡∏≠‡∏ô‡πÑ‡∏ã‡∏°‡πå CYP2C9 , CYP2C19 , CYP3A4 (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 4)
‚≠êÔ∏è LOE: +++ (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 5)
üîó ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á: reference1 (‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå 6)

‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏ì‡∏µ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£: ‡∏´‡∏≤‡∏Å‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÉ‡∏ô Google Sheet ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°:
‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏° Admin

***‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á code***
‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ intent ‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏°‡∏µ displayName ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö "get_herb_post_inr - yes" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
‚úÖ ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πà ‡πÉ‡∏´‡πâ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô outputContexts ‡∏Ç‡∏≠‡∏á intent
‚úÖ context ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏≠ context ‡∏ó‡∏µ‡πà‡∏°‡∏µ parameter "herb"
‚úÖ ‡∏ú‡∏°‡∏ï‡∏¥‡∏ï‡∏ï‡∏±‡πâ‡∏á better log ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ debugging ‡πÅ‡∏ö‡∏ö‡∏ô‡∏µ‡πâ var log = BetterLog.useSpreadsheet(); ‡πÇ‡∏õ‡∏£‡∏î‡πÅ‡∏ó‡∏£‡∏Å‡πÇ‡∏Ñ‡∏î better log ‡πÄ‡∏û‡∏∑‡πà‡∏≠ track ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö
‚úÖ ‡πÉ‡∏ô better log ‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ‡πÅ‡∏Ñ‡πà log.info(...) ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏ä‡πâ‡πÅ‡∏ö‡∏ö‡∏≠‡∏∑‡πà‡∏ô‡∏ô‡∏≠‡∏Å‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏à‡∏≤‡∏Å info ‡πÄ‡∏ä‡πà‡∏ô warning, error ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏ô

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á code ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
  var outputContexts = request.queryResult.outputContexts;
  var contextParameters = {};
  
  // Find the relevant context (getdrugdosing-followup)
  for (var i = 0; i < outputContexts.length; i++) {
    if (outputContexts[i].name.endsWith('/contexts/getdrugdosing-followup')) {
      contextParameters = outputContexts[i].parameters;
      break;
    }
  }
